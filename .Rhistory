knitr::opts_chunk$set(echo = FALSE, dpi=300,fig.width=7, message = FALSE, warning = FALSE)
xfun::pkg_attach2("ggplot2", "tidyverse", "lubridate", "tm", "knitr", "pander")
matches_joined <- read.csv("data/matches_joined.csv") %>% filter(year_cc > 2003)
knitr::opts_chunk$set(echo = FALSE, dpi=300,fig.width=7, message = FALSE, warning = FALSE)
xfun::pkg_attach2("ggplot2", "tidyverse", "lubridate", "tm", "knitr", "pander")
matches_joined <- read.csv("../data/matches_joined.csv") %>% filter(year_cc > 2003)
data_metadata <- read.csv("../data/decisions_US_metadata.csv")
knitr::opts_chunk$set(echo = FALSE, dpi=300,fig.width=7, message = FALSE, warning = FALSE)
xfun::pkg_attach2("ggplot2", "tidyverse", "lubridate", "tm", "knitr", "pander")
matches_joined <- read.csv("../data/matches_joined.csv") %>% filter(year_cc > 2003)
load("../data/US_metadata.RData")
# Formation of ECJ
matches_joined  %>%
mutate(formation = case_when(
grepl("Chamber" , formation) & !grepl("Grand Chamber", formation) ~ "Chamber",
grepl("Grand Chamber", formation) ~ "Grand Chamber",
grepl("Plenary Assembly", formation) ~ "Plenary Assembly",
grepl("single judge", formation) ~ "Single Judge",
)) %>%
group_by(formation, year_cc) %>%
summarize(count = n()) %>%
ggplot(data = ., mapping = aes(x = year_cc, y = count, fill = formation)) +
geom_col() +
scale_fill_brewer(palette="Greys") +
labs(
title = "Number of ECJ citations by ECJ formation",
subtitle = "Absolute amount",
caption = "Source: Authors",
x = "Year of the CC decision",
y = NULL,
fill = "ECJ formation")
# Most cited decisions
matches_joined  %>%
group_by(case_name) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(30) %>%
ggplot(data = ., mapping = aes(x = reorder(case_name, count), y = count)) +
geom_point() +
coord_flip() +
labs(
title = "Top 20 cited ECJ decisions",
caption = "Source: Authors",
x = NULL,
y = NULL)
# Subject matter
matches_joined  %>%
group_by(subject_matter_category) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(10) %>%
ggplot(mapping = aes(x = reorder(subject_matter_category, count), y = count)) +
geom_point() +
coord_flip() +
labs(
title = "Top 10 cited ECJ subject matters",
caption = "Source: Authors",
x = NULL,
y = NULL)
# ECJ Judge Rapporteur
matches_joined  %>%
group_by(judge_rapporteur.x) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(15) %>%
ggplot(mapping = aes(x = reorder(judge_rapporteur.x, count), y = count)) +
geom_point() +
coord_flip() +
labs(
title = "Top 15 cited ECJ judge rapporteurs",
caption = "Source: Authors",
x = NULL,
y = NULL)
# Referring Member States
matches_joined  %>%
filter(!referring_member_state == "not applicable") %>%
group_by(referring_member_state) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(15) %>%
ggplot(mapping = aes(x = reorder(referring_member_state, count), y = count)) +
geom_point() +
coord_flip() +  labs(
title = "Top 15 cited ECJ referring member states",
caption = "Source: Authors",
x = NULL,
y = NULL)
# Type of ECJ Proceedings
matches_joined  %>%
mutate(procedure_abb = case_when(
grepl("reference", procedure) ~ "Reference for a Preliminary Ruling",
grepl("fulfill", procedure) ~ "Action for Failrure to Fulfill Obligations",
grepl("annulment", procedure) ~ "Action for Annulment",
TRUE ~ "Other")) %>%
group_by(procedure_abb, year_cc) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(15) %>%
ggplot(mapping = aes(x = year_cc, y = count, fill = procedure_abb)) +
geom_col() +
scale_fill_brewer(palette="Greys") +
labs(
title = "Number of ECJ citations by ECJ type of procedure",
subtitle = "Absolute Amount",
caption = "Source: Authors",
x = "Year of the CC decision",
y = NULL,
fill = "ECJ type of trocedure")
ggplot(matches_joined, aes(x = year_cc, y = proceeding_year)) +
geom_bin2d() +
scale_fill_gradient(palette="Greys") +
labs(x = "Year of the referring CC decision", y = "Year of the cited ECJ decision",
title = "Heatmap of the dates of reference",
fill = "Count",
caption = "Source: Authors")
# Formation of ECJ
matches_joined  %>%
mutate(formation = case_when(
grepl("Chamber" , formation) & !grepl("Grand Chamber", formation) ~ "Chamber",
grepl("Grand Chamber", formation) ~ "Grand Chamber",
grepl("Plenary Assembly", formation) ~ "Plenary Assembly",
grepl("single judge", formation) ~ "Single Judge",
)) %>%
group_by(formation, year_cc) %>%
summarize(count = n()) %>%
ggplot(data = ., mapping = aes(x = year_cc, y = count, fill = formation)) +
geom_col() +
scale_fill_brewer(palette="Greys") +
labs(
title = "Number of ECJ citations by ECJ formation",
subtitle = "Absolute amount",
caption = "Source: Authors",
x = "Year of the CC decision",
y = NULL,
fill = "ECJ formation")
# Most cited decisions
matches_joined  %>%
group_by(case_name) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(30) %>%
ggplot(data = ., mapping = aes(x = reorder(case_name, count), y = count)) +
geom_point() +
coord_flip() +
labs(
title = "Top 20 cited ECJ decisions",
caption = "Source: Authors",
x = NULL,
y = NULL)
# Subject matter
matches_joined  %>%
group_by(subject_matter_category) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(10) %>%
ggplot(mapping = aes(x = reorder(subject_matter_category, count), y = count)) +
geom_point() +
coord_flip() +
labs(
title = "Top 10 cited ECJ subject matters",
caption = "Source: Authors",
x = NULL,
y = NULL)
# ECJ Judge Rapporteur
matches_joined  %>%
group_by(judge_rapporteur.x) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(15) %>%
ggplot(mapping = aes(x = reorder(judge_rapporteur.x, count), y = count)) +
geom_point() +
coord_flip() +
labs(
title = "Top 15 cited ECJ judge rapporteurs",
caption = "Source: Authors",
x = NULL,
y = NULL)
# Referring Member States
matches_joined  %>%
filter(!referring_member_state == "not applicable") %>%
group_by(referring_member_state) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(15) %>%
ggplot(mapping = aes(x = reorder(referring_member_state, count), y = count)) +
geom_point() +
coord_flip() +  labs(
title = "Top 15 cited ECJ referring member states",
caption = "Source: Authors",
x = NULL,
y = NULL)
# Type of ECJ Proceedings
matches_joined  %>%
mutate(procedure_abb = case_when(
grepl("reference", procedure) ~ "Reference for a Preliminary Ruling",
grepl("fulfill", procedure) ~ "Action for Failrure to Fulfill Obligations",
grepl("annulment", procedure) ~ "Action for Annulment",
TRUE ~ "Other")) %>%
group_by(procedure_abb, year_cc) %>%
summarize(count = n()) %>%
arrange(desc(count)) %>%
top_n(15) %>%
ggplot(mapping = aes(x = year_cc, y = count, fill = procedure_abb)) +
geom_col() +
scale_fill_brewer(palette="Greys") +
labs(
title = "Number of ECJ citations by ECJ type of procedure",
subtitle = "Absolute Amount",
caption = "Source: Authors",
x = "Year of the CC decision",
y = NULL,
fill = "ECJ type of trocedure")
ggplot(matches_joined, aes(x = year_cc, y = proceeding_year)) +
geom_bin2d() +
scale_fill_distiller(palette="Greys") +
labs(x = "Year of the referring CC decision", y = "Year of the cited ECJ decision",
title = "Heatmap of the dates of reference",
fill = "Count",
caption = "Source: Authors")
ggplot(matches_joined, aes(x = year_cc, y = proceeding_year)) +
geom_bin2d() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "Year of the referring CC decision", y = "Year of the cited ECJ decision",
title = "Heatmap of the dates of reference",
fill = "Count",
caption = "Source: Authors")
ggplot(matches_joined, aes(x = year_cc, y = proceeding_year)) +
geom_bin2d() +
scale_fill_distiller(palette="Greys") +
labs(x = "Year of the referring CC decision", y = "Year of the cited ECJ decision",
title = "Heatmap of the dates of reference",
fill = "Count",
caption = "Source: Authors")
# Total N cases per year
matches_joined_count_total <- data_metadata %>%
group_by(year_cc) %>%
summarize(count_total = n())
# Data prep for freq/outcome histogram
matches_joined  %>%
group_by(outcome, year_cc) %>%
summarize(count = n(),
count_distinct = n_distinct(doc_id)) %>%
{. ->> matches_joined_outcome}
matches_joined_freq_relative <- data_metadata %>%
group_by(outcome, year_cc) %>%
summarize(count_relative = n())
matches_joined_outcome <- left_join(matches_joined_freq_relative, matches_joined_outcome)
matches_joined_outcome <- left_join(matches_joined_outcome, matches_joined_count_total)
matches_joined_outcome$count <- matches_joined_outcome$count %>% replace_na(0)
matches_joined_outcome <- matches_joined_outcome %>%
group_by(year_cc) %>%
mutate(freq = count/count_relative,
freq_total = count/count_total,
freq_distinct = count_distinct/count_relative)
ggplot(data = matches_joined_outcome, mapping = aes(x = year_cc, y = count, fill = outcome)) +
geom_col() +
scale_fill_brewer(palette="Greys") +
labs(
title = "Number of ECJ citations in CC case law by outcome of the CC case",
subtitle = "Absolute amount",
caption = "Source: Authors",
x = "Year of the CC Decision",
y = NULL,
fill = "Outcome")
# Data prep for freq/type of proceedings histogram
matches_joined  %>%
mutate(type_proceedings = case_when(
grepl("stížnostech", type_proceedings) ~ "Concrete",
!grepl("stížnostech", type_proceedings) ~ "Abstract"
)) %>%
group_by(type_proceedings, year_cc) %>%
summarize(count = n(),
count_distinct = n_distinct(doc_id)) %>%
{. ->> matches_joined_type_proceedings}
matches_joined_type_proceedings_freq_relative <- subset(data_metadata, type_proceedings %in% c("O ústavních stížnostech", "O zrušení zákonů a jiných právních předpisů", "O souladu mezinárodních smluv")) %>%
mutate(type_proceedings = case_when(
grepl("stížnostech", type_proceedings) ~ "Concrete",
!grepl("stížnostech", type_proceedings) ~ "Abstract"
)) %>%
group_by(type_proceedings, year_cc) %>%
summarize(count_relative = n())
matches_joined_type_proceedings <- left_join(matches_joined_type_proceedings_freq_relative, matches_joined_type_proceedings)
matches_joined_type_proceedings <- left_join(matches_joined_type_proceedings, matches_joined_count_total)
matches_joined_type_proceedings$count <- matches_joined_type_proceedings$count %>% replace_na(0)
matches_joined_type_proceedings <- matches_joined_type_proceedings %>%
group_by(year_cc) %>%
mutate(freq = count/count_relative,
freq_total = count/count_total,
freq_distinct = count_distinct/count_relative)
ggplot(data = matches_joined_type_proceedings, mapping = aes(x = year_cc, y = count, fill = type_proceedings)) +
geom_col() +
scale_fill_brewer(palette="Greys") +
labs(
title = "Number of ECJ citations in CC case law by type of review",
subtitle = "Absolute amount",
caption = "Source: Authors",
x = "Year of the CC Decision",
y = NULL,
fill = "Type of review")
?scale_fill_brewer
